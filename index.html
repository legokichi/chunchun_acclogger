<script src="./jquery-2.1.3.min.js"></script>
<script src="./socket.io-1.2.1.js"></script>
<fieldset id="state">
  <legend>状態</legend>
  <label><input type="radio" name="state" value="standing" checked />立つ</label>
  <label><input type="radio" name="state" value="walking" />歩く</label>
  <label><input type="radio" name="state" value="running" />走る</label>
  <label><input type="radio" name="state" value="sitting" />座る</label>
  <label><input type="radio" name="state" value="lying" />寝る</label>
</fieldset>
<script>
(function() {
  var socket;

  console.clear();

  socket = io(location.protocol+"//"+location.host);

  socket.on("connect", function() {
    socket.emit('state', [Date.now(), $("#state input[type=radio]").val()]);
    $("#state").change(function(ev) {
      return socket.emit('state', [ev.timeStamp, $(ev.target).val()]);
    });
    addEventListener("deviceorientation", function(ev) {
      return socket.emit('deviceorientation', [ev.timeStamp, ev.alpha, ev.beta, ev.gamma]);
    });
    return addEventListener("devicemotion", function(ev) {
      return socket.emit('devicemotion', [ev.timeStamp, ev.acceleration.x, ev.acceleration.y, ev.acceleration.z, ev.accelerationIncludingGravity.x, ev.accelerationIncludingGravity.y, ev.accelerationIncludingGravity.z]);
    });
  });

}).call(this);
</script>
